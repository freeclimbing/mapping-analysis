package org.mappinganalysis.model.functions;import com.google.common.collect.Maps;import org.apache.flink.api.common.functions.MapFunction;import org.apache.flink.graph.Edge;import org.apache.flink.graph.Triplet;import org.apache.flink.types.NullValue;import org.mappinganalysis.model.FlinkVertex;import org.mappinganalysis.utils.Utils;import org.simmetrics.StringMetric;import java.util.Map;/** * Return similarity 1f if labels of two resources are equal. */public class TrigramSimilarityMapper implements MapFunction<Triplet<Long, FlinkVertex, NullValue>,    Triplet<Long, FlinkVertex, Map<String, Object>>> {  @Override  public Triplet<Long, FlinkVertex, Map<String, Object>> map(Triplet<Long, FlinkVertex, NullValue> triplet) throws Exception {    Map<String, Object> srcProps = triplet.getSrcVertex().getValue().getProperties();    String srcLabel = srcProps.containsKey(Utils.LABEL) ? srcProps.get(Utils.LABEL).toString() : Utils.NO_VALUE;    Map<String, Object> trgProps = triplet.getTrgVertex().getValue().getProperties();    String trgLabel = trgProps.containsKey(Utils.LABEL) ? trgProps.get(Utils.LABEL).toString() : Utils.NO_VALUE;    StringMetric metric = Utils.getTrigramMetric(true);    float similarity = 0f;    if (!srcLabel.equals(Utils.NO_VALUE) && !trgLabel.equals(Utils.NO_VALUE)) {      similarity = metric.compare(srcLabel.toLowerCase(), trgLabel.toLowerCase());    }    Map<String, Object> property = Maps.newHashMap();    property.put(Utils.TRIGRAM, similarity);    return new Triplet<>(        triplet.getSrcVertex(),        triplet.getTrgVertex(),        new Edge<>(            triplet.getSrcVertex().getId(),            triplet.getTrgVertex().getId(),            property));  }}