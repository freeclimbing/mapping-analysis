package org.mappinganalysis.model.functions;import org.apache.flink.api.common.functions.JoinFunction;import org.apache.flink.graph.Edge;import org.apache.flink.graph.Triplet;import org.apache.flink.graph.Vertex;import org.mappinganalysis.model.ObjectMap;/** * Join the result of two different matching results. */public class JoinSimilarityValueFunction    implements JoinFunction<Triplet<Long, ObjectMap, ObjectMap>,    Triplet<Long, ObjectMap, ObjectMap>,    Triplet<Long, ObjectMap, ObjectMap>> {  @Override  public Triplet<Long, ObjectMap, ObjectMap> join(      Triplet<Long, ObjectMap, ObjectMap> t1,      Triplet<Long, ObjectMap, ObjectMap> t2) throws Exception {    Vertex<Long, ObjectMap> source;    Vertex<Long, ObjectMap> target;    if (t1 != null) {      source = t1.getSrcVertex();      target = t1.getTrgVertex();    } else {      source = t2.getSrcVertex();      target = t2.getTrgVertex();    }    ObjectMap result = new ObjectMap();    if (t1 != null) {      result.putAll(t1.getEdge().getValue());    }    if (t2 != null) {      result.putAll(t2.getEdge().getValue());    }    return new Triplet<>(        source,        target,        new Edge<>(            source.getId(),            target.getId(),            result));  }}